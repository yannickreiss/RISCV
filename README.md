# RISC-V Prozessor #
- [RISC-V Prozessor](#risc-v-prozessor)
  - [Authors](#authors)
  - [Building Requirements](#building-requirements)
  - [Build Instructions](#build-instructions)
  - [Programming instructions](#programming-instructions)
    - [Recommended clock speed](#recommended-clock-speed)
    - [Programming the Processor](#programming-the-processor)
      - [How to enter a program?](#how-to-enter-a-program)
      - [Supported assembly operations](#supported-assembly-operations)
    - [Memory types and usage](#memory-types-and-usage)
    - [Default constraints](#default-constraints)

## Authors ##

This processor is built by Alex Graf, Carl Ries and Yannick Rei√ü.

The [original repository](https://gitlab.cs.hs-rm.de/yreis001/hbs) will not be updated anymore. All commits made to the original repository can be found in [this snapshot](hbs-master.tar.gz) of the repository.

## Building Requirements ##

- make
- ghdl

---

## Build Instructions ##

To analyze, elaborate and run all entity testbenches use seperately:

```bash
make all
```

To build just one specific testbench use:

```bash
make <entity>
```

with entity being one of

- ram
- regs
- alu
- pc
- decoder
- cpu
- imm
- branch

Clean up all unimportant and autogenerated files.

```bash
make clean
```

---

## Programming instructions ##

### Recommended clock speed ###

The processor can run with up to 100 Mhz as the highest tested value.
To avoid Glitches and other nasty effects created by overclocking, rather choose around 60-80 Mhz as clock speed.

### Programming the Processor ###

#### How to enter a program? ####

Convert your C/Assembler source-code into hexadecimal, or binary code.
Paste this binary code into imem.v to initialize the ROM with your program.

#### Supported assembly operations ####

All 32i-Base-Instructions are supported, except load and store other than full words.
Currently no further extensions are planned.

### Memory types and usage ###

The memory is divided in 4 Blocks, with 256 words of storage each, organized in words with a size of 32 bit.

The first block is a Read-Only block filled with your instructions, having the addresses from 0 to 1023.

The second block is a Read-Write block, primarily a writeable instruction memory, but can be used as all purpose storage, if needed.

The third block is the I/O-Block of the processor. It's lower half is used to set outputs. Take a look at the section below for more information.
ATTENTION: The upper half is used to read inputs to the processor. Consider these segments as **NOT WRITEABLE**  and **NOT CONSTANT**!

The fourth and last block is the only block with all-purpose memory, which should primarily be used. In the future it will become impossible to load an instruction from block four. Instead the memory will return only no-op instruction.

Addressrange per block:

| Block | first address | last address | r/w/x   |
| ----- | ------------- | ------------ | ------- |
| 1     | 0             | 1023         | r/x     |
| 2     | 1024          | 2047         | r/w/x   |
| 3     | 2048          | 3071         | r/w (!) |
| 4     | 3072          | 4095         | (r/w)   |

### Default constraints ###

By default only clock and reset are directly connected to an external signal.
The third block is connected to external sources and destinations in the following way:
Inputs:

| first address | last address | input device | size in bytes         |
| ------------- | ------------ | ------------ | --------------------- |
| 2560          | 2561         | switch       | 2                     |
| 2562          | 2563 (2562)  | button       | 1 (only first 5 bits) |

Outputs:

| first address | last address | output device      | size in bytes         |
| ------------- | ------------ | ------------------ | --------------------- |
| 2048          | 2051 (2049)  | led                | 2                     |
| 2052          | 2055         | 7 segment displays | 4                     |
| 2056          | 2959 (2056)  | rgb                | 1 (only first 6 bits) |
